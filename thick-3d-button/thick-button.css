/* Thick 3D Button Component
   ------------------------------------------
   - Massive feel with visible sidewall
   - Bottom-anchored side that compresses on press
   - Fixed base plate to keep front edge steady
   - Moving specular highlight following cursor
   - Tiny tilt/parallax toward the pointer
   - Keyboard & reduced-motion friendly
*/

/* Default theme variables (overridable per button via CSS variables) */
.btn3d{
  --radius: 22px;
  --thickness: 30px;      /* visible height of sidewall */
  --travel: 22px;         /* how deep cap travels on press */
  --tilt: 10deg;          /* max hover tilt */
  --cap-top: #e07b66;
  --cap-bottom: #c75a45;
  --side-top: #b55642;
  --side-bottom: #8d3a2c;
  --base: #5e2a22;
  --text: #ffffff;
  --specular: rgba(255,255,255,.65);
  --specular-falloff: rgba(255,255,255,.10);
}

/* Alternate demo themes */
.btn3d.blue{
  --cap-top:#6aa6ff; --cap-bottom:#3f7ce0;
  --side-top:#3a74cd; --side-bottom:#2a57a0;
  --base:#1f3966;
}
.btn3d.gold{
  --cap-top:#f1c56b; --cap-bottom:#d39c2e;
  --side-top:#c38f39; --side-bottom:#8b611f;
  --base:#5a3f16; color:#1a1308;
}

/* Wrapper: creates a stacking context and perspective for mild tilt */
.btn3d{
  appearance: none;
  position: relative;
  display: inline-block;
  border: 0;
  background: transparent;
  cursor: pointer;
  border-radius: var(--radius);
  -webkit-tap-highlight-color: transparent;
  perspective: 800px;
  transform-style: preserve-3d;
  outline: none;
}

/* Focus ring */
.btn3d:focus-visible{
  box-shadow:
    0 0 0 3px rgba(255,255,255,.8),
    0 0 0 6px rgba(36,120,255,.6);
}

/* Base plate (fixed) */
.btn3d::before{
  content:"";
  position:absolute; inset:0;
  border-radius: var(--radius);
  background: var(--base);
  /* heavy, stacked shadows give mass */
  box-shadow:
    0 calc(var(--thickness) + 18px) 44px rgba(0,0,0,.32),
    0 calc(var(--thickness) +  8px) 18px rgba(0,0,0,.26),
    0 var(--thickness) 8px rgba(0,0,0,.42);
}

/* Moving specular highlight (sits above cap) */
.btn3d::after{
  content:"";
  position:absolute; inset:-1px;
  border-radius: var(--radius);
  background: radial-gradient(140px 70px at var(--mx,50%) var(--my,30%),
              var(--specular), var(--specular-falloff) 45%, transparent 70%);
  mix-blend-mode: screen;
  filter: blur(8px);
  pointer-events:none;
  z-index: 5;
  opacity: .9;
  transition: opacity .15s ease;
}

/* Cap (top face) */
.btn3d__cap{
  position: relative;
  display: inline-block;
  padding: 20px 44px;
  border-radius: calc(var(--radius) - 2px);
  background: linear-gradient(180deg, var(--cap-top), var(--cap-bottom));
  transform: translateY(calc(-1 * var(--thickness))) rotateX(var(--rx,0deg)) rotateY(var(--ry,0deg));
  transform-style: preserve-3d;
  transition:
    transform .08s cubic-bezier(.2,.8,.1,1),
    box-shadow .12s ease;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.40),
    inset 0 -3px 8px rgba(0,0,0,.28);
  z-index: 2;
}

/* Sidewall (visible thickness), positioned off the bottom of the cap.
   We anchor it to the base by using a negative bottom equal to the thickness. */
.btn3d__cap::after{
  content:"";
  position:absolute;
  left:0; right:0;
  bottom: calc(-1 * var(--thickness));
  height: var(--thickness);
  border-radius: 0 0 calc(var(--radius) - 2px) calc(var(--radius) - 2px);
  background: linear-gradient(180deg, var(--side-top), var(--side-bottom));
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.12),
    inset 0 -3px 6px rgba(0,0,0,.28);
  pointer-events:none;
  z-index: -1; /* under the cap but above base */
}

/* Text with subtle parallax */
.btn3d__text{
  position: relative;
  display: inline-block;
  color: var(--text);
  font: 800 28px/1.05 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  transform: translateZ(8px);
  text-shadow:
    0 1px 0 rgba(255,255,255,.22),
    0 2px 6px rgba(0,0,0,.25);
}

/* Hover anticipation: tiny drop and tilt */
.btn3d:hover .btn3d__cap{
  transform: translateY(calc(-1 * var(--thickness) + 2px)) rotateX(var(--rx,1.5deg)) rotateY(var(--ry,0.5deg));
}

/* Pressed state: cap travels down; wall visually shortens but bottom edge stays put */
.btn3d.is-pressed .btn3d__cap,
.btn3d:active .btn3d__cap{
  transform: translateY(calc(-1 * var(--thickness) + var(--travel))) rotateX(var(--rx,3deg)) rotateY(var(--ry,1.5deg));
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.22),
    inset 0 -6px 12px rgba(0,0,0,.45);
}
.btn3d.is-pressed .btn3d__cap::after,
.btn3d:active .btn3d__cap::after{
  height: calc(var(--thickness) - var(--travel));
  bottom: calc(-1 * (var(--thickness) - var(--travel)));
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .btn3d__cap{ transition: none !important; }
  .btn3d::after{ display: none !important; }
}
